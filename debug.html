<!doctype html><meta charset="utf-8">
<title>Door Logger Debug</title>
<style>
  body{font-family:system-ui;margin:24px;max-width:860px}
  input,textarea{width:100%;padding:8px;margin:4px 0}
  button{padding:10px 16px;font-weight:600}
  pre{background:#111;color:#0f0;padding:12px;overflow:auto}
</style>

<h2>Endpoint</h2>
<input id="ep" value="https://script.google.com/macros/s/AKfycbwTq0s0mFo3Vd70JI0fOA66h_4jB-ehE7msfsK6i4JrHbxxgxmwL9NE0l3fGa29IhZY/exec">

<div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
  <div>
    <h3>POST</h3>
    <input id="em"        value="brent@tscstudios.com">
    <input id="ad"        value="2402 E Shangri La Rd">
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px">
      <input id="ct" value="Phoenix">
      <input id="st" value="AZ">
      <input id="zp" value="85028">
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
      <input id="la" value="33.5980">
      <input id="ln" value="-112.0120">
    </div>
    <textarea id="nt" rows="2">debug post</textarea>
    <button id="postbtn">POST</button>
    <pre id="postout"></pre>
  </div>
  <div>
    <h3>GET</h3>
    <button id="getbtn">GET</button>
    <pre id="getout"></pre>
  </div>
</div>

<script>
const $ = id => document.getElementById(id);

$('postbtn').onclick = () => {
  const payload = {
    timestamp: new Date().toISOString(),
    user_email: $('em').value,
    lat: +$('la').value,
    lng: +$('ln').value,
    address: $('ad').value,
    city: $('ct').value,
    state: $('st').value,
    zip: $('zp').value,
    notes: $('nt').value,
    source_device: 'debug',
    version: 'v0.3.5'
  };
  fetch($('ep').value, {
    method: 'POST',
    mode:   'no-cors',                // <— bypass CORS preflight
    headers:{ 'Content-Type':'application/json' },
    body:   JSON.stringify(payload)
  })
  .then(() => $('postout').textContent = '✅ POST sent (no-cors)')
  .catch(e => $('postout').textContent = '❌ POST error');
};

$('getbtn').onclick = async () => {
  try {
    const r = await fetch($('ep').value);
    const j = await r.json();
    $('getout').textContent = JSON.stringify(j.slice(0,10),null,2);
  } catch(e) {
    $('getout').textContent = String(e);
  }
};
</script>
